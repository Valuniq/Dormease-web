(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5968],{2557:function(e,a,t){"use strict";var s,l=t(2846);function r(){return(r=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e}).apply(this,arguments)}a.Z=function(e){return l.createElement("svg",r({xmlns:"http://www.w3.org/2000/svg",width:13,height:7,fill:"none"},e),s||(s=l.createElement("path",{stroke:"#323232",strokeLinecap:"round",strokeWidth:1.5,d:"m1 6 4.626-4.626a1 1 0 0 1 1.414 0L11.667 6"})))}},2984:function(e,a,t){Promise.resolve().then(t.bind(t,6399))},6399:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return _}});var s=t(7437),l=t(8640),r=t(7124),n=t(1252);let i=()=>{let{data:e,error:a}=(0,n.ZP)("".concat(l._,"/api/v1/web/dormitory/management"),r.Z);return{data:e,error:a,isLoading:!a&&!e}},c=async e=>await (0,r.Z)("".concat(l._,"/api/v1/web/dormitory/management/").concat(e),{method:"GET"}),o=async(e,a)=>await (0,r.Z)("".concat(l._,"/api/v1/web/dormitory/management/").concat(e,"/").concat(a),{method:"GET"}),d=async e=>await (0,r.Z)("".concat(l._,"/api/v1/web/dormitory/management/").concat(e,"/floor"),{method:"GET"}),m=async e=>await (0,r.Z)("".concat(l._,"/api/v1/web/dormitory/management/rooms/").concat(e,"/assigned"),{method:"GET"}),u=async e=>await (0,r.Z)("".concat(l._,"/api/v1/web/dormitory/management/rooms/").concat(e,"/not-assigned"),{method:"GET"}),g=async(e,a)=>await (0,r.Z)("".concat(l._,"/api/v1/web/dormitory/management/").concat(e,"/memo"),{method:"PUT",body:JSON.stringify({memo:a})}),b=async e=>await (0,r.Z)("".concat(l._,"/api/v1/web/dormitory/management/rooms/manual"),{method:"PUT",body:JSON.stringify(e)});var h=t(9881),x=t(5407),y=t(8871),j=t(1371),f=t(621),p=t(2763),w=t(2265),N=t(2557),v=e=>{let{label:a,disabled:t,selected:l=!1,...r}=e;return(0,s.jsx)("button",{...r,disabled:t,className:"H4 w-60 h-42 rounded-full text-gray-grayscale-50 bg-transparent ".concat(t?"disabled:text-gray-grayscale20":l?"bg-gray-grayscale30":"hover:bg-gray-grayscale20 hover:hover-transition active:bg-gray-grayscale30"),children:a})},A=e=>{let{list:a,isOn:t,setIsOn:l,select:r,setSelect:n,...i}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsxs)("button",{...i,onClick:()=>{a.length>0&&l(!t)},className:"H4 flex justify-center items-center w-75 h-41 rounded-5 bg-gray-grayscale5",children:[0===r?"층":999===r?"전체":r+"층",(0,s.jsx)(N.Z,{className:"".concat(t&&"rotate-180"," ml-10")})]}),a.length>0&&t&&(0,s.jsx)("div",{className:"mt-12 py-3 w-75 rounded-5 bg-gray-grayscale5 text-center",children:a.map((e,a)=>(0,s.jsx)("div",{className:"pt-3 pb-3",children:(0,s.jsx)(v,{label:999===e.floor?"전체":e.floor+"층",disabled:!1,selected:r===e.floor,onClick:()=>{n(e.floor),l(!t)}})},a))})]})},C=t(9517),S=e=>{let{studentList:a,onStudentClick:t,editAssign:l,roomSize:r,roomManual:n,roomId:i}=e,c=e=>{let s=a.filter(e=>e.assigned).length,l=a.find(a=>a.id===e);(s<r||l&&l.assigned)&&t(e)};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"absolute z-10 text-gray-grayscale50 mt-10 left-115",children:(0,s.jsxs)("div",{className:"balloon caption-2 max-h-256 overflow-y-auto noscrollbar-table",children:[(0,s.jsx)("table",{children:(0,s.jsx)("tbody",{children:a.map(e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("tr",{className:"w-[290px] caption-2 py-2 text-nowrap align-middle cursor-pointer ".concat(e.assigned&&l?"bg-gray-grayscale20":"hover:bg-gray-grayscale10 active:bg-gray-grayscale20"),onClick:a=>{a.stopPropagation(),c(e.id)},children:[(0,s.jsx)("td",{className:"rounded-l-5 pr-20 pl-10 min-w-100",children:e.studentNumber}),(0,s.jsx)("td",{className:"pr-20 min-w-60",children:e.name}),(0,s.jsx)("td",{className:"rounded-r-5 pr-10 min-w-100",children:e.phoneNumber})]},e.id),(0,s.jsx)("tr",{className:"h-10"})]}))})}),l&&(0,s.jsx)("div",{className:"mt-4 mb-14",children:(0,s.jsx)(j.Z,{label:"배정",variant:"blue",disabled:!1,selected:!1,onClick:()=>n&&n(i)})})]})})})},k=e=>{let{roomId:a,roomNumber:t,roomSize:l,gender:r,currentPeople:n,listClick:i,onListClick:c,onStudentClick:o,studentList:d,editAssign:m,roomManual:u}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("tr",{className:"table rounded-5 w-[734px] H4-caption text-nowrap align-middle cursor-pointer hover:bg-gray-grayscale10 active:bg-gray-grayscale20",onClick:e=>{e.stopPropagation(),c(a)},children:[(0,s.jsxs)("td",{className:"w-[20%]",children:[t,"호"]}),(0,s.jsxs)("td",{className:"w-[30%] text-blue-blue30 underline",children:[l,"인실"]}),(0,s.jsx)("td",{className:"w-[30%]",children:"MALE"===r?"남":"여"}),(0,s.jsxs)("td",{className:"w-[20%] H3 text-gray-grayscale30",children:[(0,s.jsx)("h3",{className:"text-blue-blue30 inline-flex",children:n}),"/",l]})]}),a===i&&(0,s.jsx)("tr",{className:"relative",children:(0,s.jsx)("td",{colSpan:4,children:(0,s.jsx)(S,{studentList:d,onStudentClick:o,editAssign:m,roomSize:l,roomManual:u,roomId:a})})}),(0,s.jsx)("tr",{className:"h-8"})]})},Z=t(3122),E=e=>{let{roomList:a,studentList:t,listClick:l,onListClick:r,onStudentClick:n,editAssign:i,roomManual:c}=e;return(0,s.jsxs)("table",{className:"text-nowrap text-center text-gray-grayscale50",children:[(0,s.jsxs)("thead",{className:"table w-[734px]",children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"H4 w-[20%]",children:"호 실"}),(0,s.jsx)("th",{className:"H4 w-[30%]",children:"인 실"}),(0,s.jsx)("th",{className:"H4 w-[30%]",children:"성 별"}),(0,s.jsx)("th",{className:"H4 w-[20%]",children:"인 원"})]}),(0,s.jsx)("tr",{className:"h-12 border-b-1"})]}),a&&a.length>0?(0,s.jsxs)("tbody",{className:"block w-[748px] h-695 overflow-y-auto scrollbar-table",children:[(0,s.jsx)("tr",{className:"h-12"}),a.map(e=>(0,s.jsx)(k,{roomId:e.id,roomNumber:e.roomNumber,roomSize:e.roomSize,gender:e.gender,currentPeople:e.currentPeople,listClick:l,onListClick:r,onStudentClick:n,studentList:t,editAssign:i,roomManual:c},e.id))]}):(0,s.jsx)("tbody",{children:(0,s.jsx)(Z.Z,{colspan:4})})]})},H=t(1723),O={src:"/_next/static/media/Memo.8b25f92c.png",height:31,width:130,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAMAAABSSm3fAAAAD1BMVEVGRkZHR0dGRkZHR0dHR0d9S03gAAAABXRSTlOmj5qAbuk7I9gAAAAJcEhZcwAAEJwAABCcASbNOjQAAAAWSURBVHicY2BgYmAEIwZGRhYmJmZGAACvABdKKZAVAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:2},L=t(703),R=e=>{let{buildingList:a}=e,[t,l]=(0,w.useState)(!1),[r,n]=(0,w.useState)(!1),[i,N]=(0,w.useState)(a[0]),[v,S]=(0,w.useState)([]),[k,Z]=(0,w.useState)(!1),[R,_]=(0,w.useState)(0),[I,P]=(0,w.useState)([]),[U,G]=(0,w.useState)({name:"",imageUrl:null,fullRoomCount:0,roomCount:0,currentPeopleCount:0,dormitorySize:0,memo:null}),[T,z]=(0,w.useState)(U.memo),[B,M]=(0,w.useState)(0),[F,J]=(0,w.useState)([]),[V,K]=(0,w.useState)([]),[W,Y]=(0,w.useState)([]),[D,Q]=(0,w.useState)([]),[q,X]=(0,w.useState)(!1),[$,ee]=(0,w.useState)(!1),[ea,et]=(0,w.useState)([]),[es,el]=(0,w.useState)(!1),er=(0,w.useRef)(null),[en,ei]=(0,w.useState)({building:null,floor:null});(0,w.useEffect)(()=>{if(V.some(e=>e.roomId===B)){let e=V.find(e=>e.roomId===B);e&&Q(e.resident.concat(W))}else Q(F.concat(W))},[B,F,W,V]);let ec=async e=>{let a=await c(e);a.check?(G(a.information),z(a.information.memo)):G({name:"",imageUrl:null,fullRoomCount:0,roomCount:0,currentPeopleCount:0,dormitorySize:0,memo:null})};(0,w.useEffect)(()=>{(async()=>{l(!0),await ec(i.id)})()},[i]);let eo=async e=>{let a=await d(e);S(a.information),a.information.length>0?(_(999),ed(e,999)):(_(0),ed(e,0))},ed=async(e,a)=>{P((await o(e,a)).information)},em=async()=>{null!==T&&(await g(i.id,T)).check&&G(e=>({...e,memo:T}))},eu=async e=>{let a=await m(e);a.check?(J(a.information),q&&(a.information.length>0||W.length>0)?M(e):a.information.length>0?M(e):M(0)):J([])},eg=async e=>{let a=await u(e);a.check?Y(a.information):Y([])},eb=async()=>{(await b(ea)).check&&(ee(!$),X(!q),M(0),et([]),K([]))},eh=()=>{var e;null===(e=er.current)||void 0===e||e.click()},ex=async e=>{if(!e.target.files||0===e.target.files.length){console.log("파일이 선택되지 않았습니다.");return}let a=e.target.files[0],t=URL.createObjectURL(a);(await (0,h.to)(i.id,a)).check&&G(e=>({...e,imageUrl:t}))},ey=async()=>{en.building?(N({id:en.building.id,name:en.building.name}),eo(en.building.id),Z(!1),ec(en.building.id),eg(en.building.id)):en.floor&&(_(en.floor),ed(i.id,en.floor),eg(i.id)),X(!1),M(0),ei({building:null,floor:null}),et([]),K([]),el(!1)};return(0,s.jsx)(s.Fragment,{children:t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"w-381 h-241 flex items-center justify-center bg-gray-grayscale5 rounded-8 mb-35",children:[U.imageUrl?(0,s.jsx)(f.Z,{image:U.imageUrl,name:U.name,onClick:eh}):(0,s.jsx)(x.Z,{label:"사진 추가",disabled:!1,variant:"blue",onClick:eh}),(0,s.jsx)("input",{id:"fileInput",type:"file",accept:"image/*",style:{display:"none",visibility:"hidden"},ref:er,onChange:ex})]}),(0,s.jsx)("table",{children:(0,s.jsxs)("tbody",{className:"H4 text-left",children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"text-gray-grayscale30 border-r-1 pb-20",children:"건 물 명"}),(0,s.jsx)("td",{className:"text-gray-grayscale50 pl-15 pb-20",children:U.name})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"text-gray-grayscale30 border-r-1 pb-20",children:"방 개 수"}),(0,s.jsxs)("td",{className:"text-gray-grayscale50 pl-15 pb-20",children:[U.fullRoomCount,"/",U.roomCount]})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"text-gray-grayscale30 border-r-1 pr-15",children:"수용인원"}),(0,s.jsxs)("td",{className:"text-gray-grayscale50 pl-15",children:[U.currentPeopleCount,"/",U.dormitorySize]})]})]})}),(0,s.jsx)("div",{className:"mt-30",children:(0,s.jsxs)("div",{className:"w-380 h-350 bg-yellow-memoyellow flex flex-col items-center pt-18 shadow2",children:[(0,s.jsx)(L.default,{src:O,alt:"Memo",width:86.49,height:20.34}),(0,s.jsxs)("div",{className:"text-gray-grayscale50 mt-20 w-318 relative",children:[(0,s.jsx)("textarea",{className:"H4-caption leading-[34px] w-full h-204 bg-yellow-memoyellow border-none outline-none scrollbar-table resize-none",value:null===T?"":T,onChange:e=>z(e.target.value)}),(0,s.jsx)("hr",{className:"border-b-1 border-gray-grayscale30 w-318 absolute top-28"}),(0,s.jsx)("hr",{className:"border-b-1 border-gray-grayscale30 w-318 absolute top-63"}),(0,s.jsx)("hr",{className:"border-b-1 border-gray-grayscale30 w-318 absolute top-98"}),(0,s.jsx)("hr",{className:"border-b-1 border-gray-grayscale30 w-318 absolute top-133"}),(0,s.jsx)("hr",{className:"border-b-1 border-gray-grayscale30 w-318 absolute top-168"}),(0,s.jsx)("hr",{className:"border-b-1 border-gray-grayscale30 w-318 absolute top-[203px]"})]}),(0,s.jsx)("div",{className:"mt-20",children:(0,s.jsx)(j.Z,{label:"저장",disabled:null===T||T===U.memo,selected:!1,variant:"blue",onClick:em})})]})})]}),(0,s.jsx)("div",{className:"border-r-1 mx-29 h-790"}),(0,s.jsxs)("div",{className:"mt-20",children:[q?(0,s.jsx)(E,{listClick:B,onListClick:e=>{B===e?M(0):eu(e)},onStudentClick:e=>{Q(a=>a.map(a=>a.id===e?{...a,assigned:!a.assigned}:a))},roomList:I,studentList:D,editAssign:q,roomManual:e=>{let a={roomId:e,residentIds:D.filter(e=>e.assigned).map(e=>e.id)};et(t=>[...t.filter(a=>a.roomId!==e),a]);let t=D.filter(e=>e.assigned),s={roomId:e,resident:t};K(a=>[...a.filter(a=>a.roomId!==e),s]),Y(D.filter(e=>!e.assigned)),M(0),P(a=>a.map(a=>a.id===e?{...a,currentPeople:t.length}:a)),console.log(JSON.stringify(ea))}}):(0,s.jsx)(E,{listClick:B,onListClick:e=>{B===e?M(0):eu(e)},onStudentClick:()=>{},roomList:I,studentList:F,editAssign:q}),(0,s.jsx)("div",{className:"flex justify-end mt-21",children:(0,s.jsx)(y.Z,{label:q?"저장":"수기배정",disabled:!1,variant:"blue",onClick:()=>{q?ee(!$):(M(0),X(!q))}})})]})]}),(0,s.jsx)("div",{className:"absolute top-0 right-0",children:(0,s.jsxs)("div",{className:"flex gap-19 mt-14",children:[(0,s.jsx)(p.Z,{isOn:r,select:i,list:a,setSelect:(e,a)=>{q?(ei({building:{id:e,name:a},floor:null}),el(!es)):(X(!1),N({id:e,name:a}),eo(e),Z(!1),ec(e),eg(e),M(0))},setIsOn:()=>n(!r)}),(0,s.jsx)(A,{list:v,isOn:k,setIsOn:()=>Z(!k),select:R,setSelect:e=>{q?(ei({building:null,floor:e}),el(!es)):(_(e),ed(i.id,e),M(0))}})]})}),$&&(0,s.jsx)(C.Z,{isOpen:$,children:(0,s.jsx)(H.Z,{variant:"blue",label:"배정된 호실을 저장하시겠습니까?",onConfirm:eb,onCancel:()=>ee(!$)})}),es&&(0,s.jsx)(C.Z,{isOpen:es,children:(0,s.jsx)(H.Z,{variant:"red",label:"이 페이지를 떠나시면 설정 내용이 저장되지 않습니다.",onConfirm:ey,onCancel:()=>el(!es)})})]})})},_=()=>{let{data:e,error:a,isLoading:t}=i();return(0,s.jsxs)("div",{className:"flex flex-col relative w-[1174px]",children:[(0,s.jsx)("div",{className:"flex items-center mb-8",children:(0,s.jsx)("div",{className:"flex justify-center w-full",children:(0,s.jsx)("h1",{className:"H0 text-gray-grayscale50 text-nowrap",children:"건물관리"})})}),e&&(0,s.jsx)(R,{buildingList:e.information})]})}},1371:function(e,a,t){"use strict";var s=t(7437);t(2265),a.Z=e=>{let{label:a,disabled:t,selected:l=!1,variant:r,...n}=e;return(0,s.jsx)("button",{...n,disabled:t,className:"H4 w-79 h-34 rounded-full text-white hover:hover-transition ".concat((e=>{switch(e){case"blue":return"".concat(l?"bg-blue-blue50":"bg-blue-blue30 disabled:bg-blue-blue20 hover:bg-blue-blue40 active:bg-blue-blue50");case"red":return"".concat(l?"bg-red-red40":"bg-red-red20 disabled:bg-red-red10 hover:bg-red-red30 active:bg-red-red40");default:return""}})(r)),children:a})}},2763:function(e,a,t){"use strict";var s=t(7437);t(2265);var l=t(2557),r=t(8871);a.Z=e=>{let{list:a,isOn:t,setIsOn:n,select:i,setSelect:c,...o}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsxs)("button",{...o,onClick:()=>n(!t),className:"H4 flex justify-between items-center px-13 w-164 h-41 rounded-5 bg-gray-grayscale5",children:[i.name,(0,s.jsx)(l.Z,{className:"".concat(t&&"rotate-180")})]}),t&&(0,s.jsx)("div",{className:"mt-12 py-3 w-164 rounded-5 bg-gray-grayscale5 text-center",children:a.map((e,a)=>(0,s.jsx)("div",{className:"pt-10 pb-10",children:(0,s.jsx)(r.Z,{label:e.name,variant:"white",disabled:!1,selected:i.id===e.id,onClick:()=>{c(e.id,e.name),n(!t)}})},a))})]})}},3122:function(e,a,t){"use strict";var s=t(7437);t(2265),a.Z=e=>{let{colspan:a}=e;return(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:a,className:"h-full",children:(0,s.jsx)("div",{className:"flex justify-center items-center h-693",children:(0,s.jsx)("h1",{className:"H1 text-gray-grayscale30",children:"리스트가 비었습니다."})})})})}}},function(e){e.O(0,[703,4898,1252,6830,2971,8069,1744],function(){return e(e.s=2984)}),_N_E=e.O()}]);