(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6749],{9553:function(e,t,n){Promise.resolve().then(n.bind(n,4590))},4590:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var s=n(7437),r=n(2265),a=n(1867),i=e=>{let{index:t,id:n,name:r,studentNumber:a,phoneNumber:i,bonusPoint:o,minusPoint:c,createdAt:l}=e;return(0,s.jsxs)("tr",{className:"h-38 hover-transition cursor-pointer hover:bg-gray-grayscale10 active:bg-gray-grayscale20 H4-caption text-gray-grayscale50",children:[(0,s.jsx)("td",{className:"text-center",children:t}),(0,s.jsx)("td",{className:"text-center",children:r}),(0,s.jsx)("td",{className:"text-center",children:a}),(0,s.jsx)("td",{className:"text-center",children:i}),(0,s.jsx)("td",{className:"text-center",children:o}),(0,s.jsx)("td",{className:"text-center",children:c}),(0,s.jsx)("td",{className:"text-center",children:l})]})},o=n(3122),c=e=>{let{className:t,width:n,height:r,fillColor:a}=e;return(0,s.jsx)("svg",{className:t,width:n,height:r,viewBox:"0 0 16 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M7.29289 0.707107L1.70711 6.29289C1.07714 6.92286 1.52331 8 2.41421 8L13.5858 8C14.4767 8 14.9229 6.92286 14.2929 6.2929L8.70711 0.707108C8.31658 0.316584 7.68342 0.316583 7.29289 0.707107Z",fill:a})})},l=e=>{let{appMemberManagementLists:t,sortConfig:n,setSortConfig:a}=e,l=e=>n.sortBy===e?n.isAscending?"rotate-0 ":"rotate-180":"",d=e=>n.sortBy===e?"#3678D8":"#323232";return(0,s.jsx)("div",{className:"w-fit h-693 overflow-y-scroll overflow-x-visible border-b-1 border-b-gray-grayscale50",children:(0,s.jsxs)("table",{className:"w-[1305px]",children:[(0,s.jsxs)("thead",{className:" w-full h-36 bg-white text-gray-grayscale50 sticky top-0 z-1",children:[(0,s.jsxs)("tr",{className:"",children:[(0,s.jsx)("th",{className:"H4",children:"번호"}),(0,s.jsx)("th",{className:"H4",children:"이름"}),(0,s.jsx)("th",{className:"H4",children:"학번"}),(0,s.jsx)("th",{className:"H4",children:"휴대전화"}),(0,s.jsx)("th",{className:"h-30 rounded-8  cursor-pointer",onClick:()=>a("bonusPoint"),style:{backgroundColor:"bonusPoint"===n.sortBy?"#DAE9FF":"transparent"},children:(0,s.jsxs)("div",{className:"H4 flex items-center justify-center text-center ",children:[(0,s.jsx)("h1",{className:"mr-4",children:"상점"}),(0,s.jsx)(c,{className:"object-contain ".concat(l("bonusPoint")),width:16,height:8,fillColor:d("bonusPoint")})]})}),(0,s.jsx)("th",{className:"h-30 rounded-8  cursor-pointer",onClick:()=>a("minusPoint"),style:{backgroundColor:"minusPoint"===n.sortBy?"#DAE9FF":"transparent"},children:(0,s.jsxs)("div",{className:"H4 flex items-center justify-center text-center w-full",children:[(0,s.jsx)("h1",{className:"mr-4",children:"벌점"}),(0,s.jsx)(c,{className:"object-contain ".concat(l("minusPoint")),width:16,height:8,fillColor:d("minusPoint")})]})}),(0,s.jsx)("th",{className:"h-30 rounded-8 cursor-pointer",onClick:()=>a("createdDate"),style:{backgroundColor:"createdDate"===n.sortBy?"#DAE9FF":"transparent"},children:(0,s.jsxs)("div",{className:"H4 flex items-center justify-center text-center w-full",children:[(0,s.jsx)("h1",{className:"mr-4",children:"생성일자"}),(0,s.jsx)(c,{className:"object-contain ".concat(l("createdDate")),width:16,height:8,fillColor:d("createdDate")})]})})]}),(0,s.jsx)("tr",{children:(0,s.jsx)("th",{colSpan:8,children:(0,s.jsx)("div",{className:"w-[1305px] h-18 border-b-1 border-b-gray-grayscale50"})})})]}),t&&t.length>0?(0,s.jsxs)("tbody",{className:"overflow-y-scroll",children:[(0,s.jsx)("tr",{className:"h-15"}),t.map((e,t)=>(0,s.jsxs)(r.Fragment,{children:[(0,s.jsx)(i,{index:t+1,id:e.id,name:e.name,studentNumber:e.studentNumber,phoneNumber:e.phoneNumber,bonusPoint:e.bonusPoint,minusPoint:e.minusPoint,createdAt:e.createdAt}),(0,s.jsx)("tr",{className:"h-15"})]},"".concat(e.id,"-").concat(t)))]}):(0,s.jsx)("tbody",{children:(0,s.jsx)(o.Z,{colspan:7})})]})})},d=n(8640),u=n(7124),h=n(4817);let g=()=>{var e,t,n;let{data:s,error:r,size:a,setSize:i,mutate:o,isValidating:c}=(0,h.ZP)((e,t)=>0===e?"".concat(d._,"/api/v1/web/users/management?page=1"):t&&0===t.information.dataList.length?null:"".concat(d._,"/api/v1/web/users/management?page=").concat(e+1),u.Z,{initialSize:1}),l=s?s.reduce((e,t)=>e.concat(t.information.dataList),[]):[],g=!s&&!r||a>0&&c&&s&&void 0===s[a-1];return{userData:l,error:r,isLoadingMore:g,size:a,setSize:i,isReachingEnd:(null==s?void 0:null===(e=s[0])||void 0===e?void 0:e.information.dataList.length)===0||s&&(null===(t=s[s.length-1])||void 0===t?void 0:t.information.pageInfo.currentPage)===(null===(n=s[s.length-1])||void 0===n?void 0:n.information.pageInfo.totalPage)||!1,mutate:o}},m=function(){var e,t,n;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bonusPoint",r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{data:a,error:i,size:o,setSize:c,mutate:l}=(0,h.ZP)((e,t)=>t&&0===t.information.dataList.length?null:"".concat(d._,"/api/v1/web/users/management/sort?sortBy=").concat(s,"&isAscending=").concat(r,"&page=").concat(e+1),u.Z,{initialSize:1}),g=a?a.reduce((e,t)=>e.concat(t.information.dataList),[]):[],m=!a&&!i||o>0&&a&&void 0===a[o-1];return{userData:g,error:i,isLoadingMore:m,size:o,setSize:c,isReachingEnd:(null==a?void 0:null===(e=a[0])||void 0===e?void 0:e.information.dataList.length)===0||a&&(null===(t=a[a.length-1])||void 0===t?void 0:t.information.pageInfo.currentPage)===(null===(n=a[a.length-1])||void 0===n?void 0:n.information.pageInfo.totalPage)||!1,mutate:l}},x=e=>{var t,n,s;let{data:r,error:a,size:i,setSize:o,mutate:c}=(0,h.ZP)((t,n)=>n&&0===n.information.dataList.length?null:"".concat(d._,"/api/v1/web/users/management/search?keyword=").concat(e,"&page=").concat(t+1),u.Z,{initialSize:1}),l=r?r.reduce((e,t)=>e.concat(t.information.dataList),[]):[],g=!r&&!a||i>0&&r&&void 0===r[i-1];return{userData:l,error:a,isLoadingMore:g,size:i,setSize:o,isReachingEnd:(null==r?void 0:null===(t=r[0])||void 0===t?void 0:t.information.dataList.length)===0||r&&(null===(n=r[r.length-1])||void 0===n?void 0:n.information.pageInfo.currentPage)===(null===(s=r[r.length-1])||void 0===s?void 0:s.information.pageInfo.totalPage),mutate:c}};var f=()=>{let[e,t]=(0,r.useState)({sortBy:void 0,isAscending:void 0}),[n,i]=(0,r.useState)(""),[o,c]=(0,r.useState)(!1),{userData:d,error:u,isLoadingMore:h,size:f,setSize:v,isReachingEnd:y,mutate:j}=m(e.sortBy,e.isAscending),{userData:A,error:p,isLoadingMore:N,size:b,setSize:w,isReachingEnd:B,mutate:E}=x(n),{userData:C,error:L,isLoadingMore:k,size:S,setSize:P,isReachingEnd:z,mutate:I}=g(),Z=(0,r.useRef)(null),D=(0,r.useRef)(null),H=(0,r.useCallback)(t=>{!t[0].isIntersecting||(!o||N||B?o||!e.sortBy||h||y?o||e.sortBy||k||z||P(e=>e+1):v(e=>e+1):w(e=>e+1))},[o,N,B,h,y,k,z,w,v,P,e.sortBy]);(0,r.useEffect)(()=>{Z.current&&Z.current.disconnect(),Z.current=new IntersectionObserver(H),D.current&&Z.current.observe(D.current)},[H]),(0,r.useEffect)(()=>{o||void 0!==e.sortBy||(P(1),I())},[e.sortBy,o,P,I]),(0,r.useEffect)(()=>{void 0===e.sortBy||o||(v(1),j())},[e,v,o,j]),(0,r.useEffect)(()=>{n?(c(!0),w(1),E()):(c(!1),e.sortBy?(v(1),j()):(P(1),I()))},[n,w,v,P,e.sortBy,E,j,I]);let M=o?N:e.sortBy?h:k,R=o?B:e.sortBy?y:z,_=o?A:e.sortBy?d:C;return(0,s.jsxs)("div",{className:"w-[1250px]",children:[(0,s.jsxs)("div",{className:"flex items-center justify-end mb-44",children:[(0,s.jsx)("h1",{className:"H0 text-gray-grayscale50 mr-117",children:"앱 회원관리"}),(0,s.jsx)(a.Z,{input:n,setInput:e=>{i(e)},placeholder:"이름 또는 학번"})]}),(0,s.jsx)(l,{appMemberManagementLists:_,sortConfig:e,setSortConfig:e=>{t(t=>t.sortBy!==e?{sortBy:e,isAscending:!0}:void 0===t.isAscending?{sortBy:e,isAscending:!0}:!0===t.isAscending?{sortBy:e,isAscending:!1}:{sortBy:void 0,isAscending:void 0})}}),(0,s.jsxs)("div",{ref:D,className:"flex justify-center mt-4",children:[M&&(0,s.jsx)("span",{children:"Loading..."}),R&&(0,s.jsx)("span",{children:"No more data"})]})]})}},1867:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var s=n(7437),r=n(703),a={src:"/_next/static/media/SearchIcon.fd87d628.png",height:20,width:20,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAGFBMVEW7u7vMzMzNzc3Ozs7MzMzLy8vLy8vOzs6cMFoWAAAACHRSTlMBlqENf1hlKKFJ7xkAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAwSURBVHicJYpJCgBADMJi7fL/Hw8yOUiQwJQ0wAqIlQELitD3xTLbaTKrVuvyn7l6DrcAeLXaQ4sAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},i=e=>{let{input:t,setInput:n,placeholder:i}=e;return(0,s.jsxs)("div",{className:"".concat(t?"border-gray-grayscale50":"border-gray-grayscale30"," focus:border-gray-grayscale40 border-[1.5px] w-380 h-38 flex items-center rounded-5"),children:[(0,s.jsx)("input",{className:"outline-none H4-cation px-12 w-292 h-24  text-gray-grayscale50 placeholder:text-gray-grayscale30",placeholder:i,type:"text",value:t,onChange:e=>{n(e.target.value)}}),(0,s.jsx)(r.default,{src:a,width:18,height:18,className:"ml-auto mr-9 object-contain",alt:"SearchIcon"})]})}},3122:function(e,t,n){"use strict";var s=n(7437);n(2265),t.Z=e=>{let{colspan:t}=e;return(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:t,className:"h-full",children:(0,s.jsx)("div",{className:"flex justify-center items-center h-693",children:(0,s.jsx)("h1",{className:"H1 text-gray-grayscale30",children:"리스트가 비었습니다."})})})})}},8640:function(e,t,n){"use strict";n.d(t,{_:function(){return s}});let s="https://www.dormease-dev.kro.kr"},9652:function(e,t,n){"use strict";n.d(t,{L:function(){return s},z:function(){return r}});let s="ACCESS_TOKEN",r="REFRESH_TOKEN"},7124:function(e,t,n){"use strict";var s=n(7871),r=n(9652);let a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=s.Z.getToken(r.L);if(!n)throw Error("No access token found");let a={...t.headers,Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},i=await fetch(e,{...t,headers:a});if(!i.ok)throw 401===i.status&&(s.Z.removeToken(r.L),s.Z.removeToken(r.z),alert("세션이 만료되었습니다. 다시 로그인해 주세요.")),Error("Failed to fetch data");return i.json()};t.Z=a},7871:function(e,t){"use strict";t.Z={saveToken:(e,t)=>{localStorage.setItem(e,t)},getToken:e=>localStorage.getItem(e),removeToken:e=>{localStorage.removeItem(e)}}}},function(e){e.O(0,[703,4898,4817,2971,8069,1744],function(){return e(e.s=9553)}),_N_E=e.O()}]);